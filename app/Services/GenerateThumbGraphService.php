<?php

namespace App\Services;


class GenerateThumbGraphService
{

    /** var OtherService */
    /*private $otherService;

    public function __construct(OtherService $otherService)
    {
        $this->otherService = $otherService;
    }

    public function execute(int $parameter): TestEntity
    {
       $this->otherService->execute();
    }*/

    private $coinGraphData;
    private $finishedGraphData;

    public function setArrayData($coinData){
        $this->coinGraphData = $coinData;
        //dd($this->coinGraphData);
    }

    public function getGraphData(){
        return $this->finishedGraphData;
    }

    public function generateGraph(){
        $graphArray = [];
        foreach ($this->coinGraphData as $id => $value) {
            $maxValue = max($this->coinGraphData[$id]);
            $minValue = min($this->coinGraphData[$id]);

            $img = "<svg width='168' height='50' viewBox='0 0 168 50' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'> <polyline xmlns='http://www.w3.org/2000/svg' points='";
            for ($i=0; $i < count($this->coinGraphData[$id]) ; $i++) { 
                $newPrice = ($this->coinGraphData[$id][$i] - $minValue) / ($minValue - $maxValue);
                $valueTest = abs((abs($newPrice * 50)) - 50); 
                $normalisedPrice[$id][$i] = abs((abs($newPrice * 50)) - 50);
                $img .= " $i,$valueTest ";
            }
            //dd($normalisedPrice);
            $img .="' fill='none' stroke='#ed5565' stroke-width='1.25'/></svg>";
            $graphArray[$id] = $img;
            //printf($img);
            
        }
        $this->finishedGraphData = $graphArray;
    }

    public function generateDummyGraph(){
        printf($img="
        <svg width='135' height='50' 
        viewBox='0 0 135 50' 
        xmlns='http://www.w3.org/2000/svg' 
        xmlns:xlink='http://www.w3.org/1999/xlink'>

        <polyline xmlns='http://www.w3.org/2000/svg' 
        points='0.0, 4.8688089175172795
        0.7988165680473372, 2.2009987349626323
        1.5976331360946745, 4.491816069904026
        2.396449704142012, 1.570533413016918
        3.195266272189349, 3.4211904735512633
        3.994082840236686, 1.9654893316679627
        4.792899408284024, 10.319745027533173
        5.591715976331361, 6.491101823557344
        6.390532544378698, 2.94182260382981
        7.189349112426036, 2.4244382652176846
        7.988165680473372, 0.0
        8.78698224852071, 5.971355110248462
        9.585798816568047, 10.936728833130568
        10.384615384615385, 14.197011669558538
        11.183431952662723, 19.19670636464194
        11.982248520710058, 21.02608720911319
        12.781065088757396, 38.882641004552966
        13.579881656804734, 30.892971499280677
        14.378698224852071, 32.11125756994379
        15.177514792899409, 26.76381235713336
        15.976331360946745, 26.188850926495356
        16.775147928994084, 29.660808351128697
        17.57396449704142, 32.83159899480292
        18.37278106508876, 32.00384937698109
        19.171597633136095, 35.67483383933284
        19.970414201183434, 33.21513766934498
        20.76923076923077, 28.505112148116257
        21.56804733727811, 31.413408985771163
        22.366863905325445, 27.37957476905421
        23.16568047337278, 33.44787980279056
        23.964497041420117, 36.32044108011727
        24.763313609467456, 48.33250146026417
        25.562130177514792, 45.00983443927984
                                         26.36094674556213, 45.320407664441674
                                          27.159763313609467, 47.182889076921555
                                           27.958579881656807, 45.963694117007655
                                            28.757396449704142, 50.0
                                             29.55621301775148, 39.14918060272005
                                              30.355029585798817, 39.50844516524748
                                               31.153846153846157, 34.43398913797707
                                                31.95266272189349, 35.27890293182894
                                                 32.751479289940825, 34.924099169285874
                                                  33.55029585798817, 39.05788519036086
                                                   34.349112426035504, 42.49378466820629
                                                    35.14792899408284, 40.31033869990258
                                                     35.94674556213018, 37.531623980024996
                                                      36.74556213017752, 35.636305285608486
                                                       37.54437869822485, 36.810546954870304
                                                        38.34319526627219, 38.98101764976133
                                                         39.142011834319526, 38.8692429948197
                                                          39.94082840236687, 35.565645714732206
                                                           40.7396449704142, 31.064757248048693
                                                            41.53846153846154, 30.47661968744519
                                                             42.337278106508876, 30.831689634328434
                                                              43.13609467455622, 28.73844755239511
                                                               43.93491124260355, 30.597486325543194
                                                                44.73372781065089, 32.47632383297307
                                                                 45.532544378698226, 35.03713490556105
                                                                  46.33136094674556, 37.014247323135244
                                                                   47.1301775147929, 36.698755476525285
                                                                    47.928994082840234, 34.638295564854815
                                                                     48.72781065088758, 32.164505055334175
                                                                      49.52662721893491, 35.336812116007586
                                                                       50.32544378698225, 35.79182149875063
                                                                        51.124260355029584, 45.040913197205676
                                                                         51.92307692307693, 40.98613670911402
                                                                          52.72189349112426, 42.48577487904909
                                                                           53.5207100591716, 38.97491784583205
                                                                            54.319526627218934, 42.676255600272796
                                                                             55.11834319526627, 43.5469299668434
                                                                              55.91715976331361, 42.61838906058823
                                                                               56.71597633136094, 39.3740578725856
                                                                                57.514792899408285, 37.64942289437849
                                                                                 58.31360946745562, 19.705072168644875
                                                                                  59.11242603550296, 19.579406389365776
                                                                                   59.91124260355029, 18.64003480462372
                                                                                    60.710059171597635, 14.251405311028076
                                                                                     61.50887573964497, 14.649710274545777
                                                                                      62.307692307692314, 9.744752823093128
                                                                                       63.10650887573964, 10.412255781651199
                                                                                        63.90532544378698, 9.69268181217013
                                                                                         64.70414201183432, 9.923067102452007
                                                                                          65.50295857988165, 12.900489201952414
                                                                                           66.30177514792899, 11.764541054940228
                                                                                            67.10059171597634, 9.798958880677166
                                                                                             67.89940828402366, 10.423708439937986
                                                                                              68.69822485207101, 16.335594199781415
                                                                                               69.49704142011834, 17.755285525077905
                                                                                                70.29585798816568, 14.777656683896327
                                                                                                 71.09467455621302, 13.917413459493572
                                                                                                  71.89349112426036, 17.146495409170186
                                                                                                   72.6923076923077, 17.3750578433214
                                                                                                    73.49112426035504, 19.32166654429737
                                                                                                     74.28994082840237, 19.20841621992245
                                                                                                      75.0887573964497, 3.1217654178254324
                                                                                                       75.88757396449704, 7.168968814744178
                                                                                                        76.68639053254438, 12.574280007547479
                                                                                                         77.48520710059172, 18.202386448270065
                                                                                                          78.28402366863905, 20.88603355329976
                                                                                                           79.0828402366864, 19.360416659833223
                                                                                                            79.88165680473374, 18.944607006114964
                                                                                                             80.68047337278107, 20.57185063461055
                                                                                                              81.4792899408284, 30.758423926394922
                                                                                                               82.27810650887574, 25.5405421977514
                                                                                                                83.07692307692308, 22.701546216828696
                                                                                                                 83.87573964497041, 21.844648631633078
                                                                                                                  84.67455621301775, 19.320830497562152
                                                                                                                   85.4733727810651, 18.366225477465655
                                                                                                                    86.27218934911244, 17.60309346044323
                                                                                                                     87.07100591715975, 16.681359145049317
                                                                                                                      87.8698224852071, 16.98067562266583
                                                                                                                       88.66863905325444, 12.463964195224477
                                                                                                                        89.46745562130178, 17.630384019984042
                                                                                                                         90.26627218934911, 13.534132227735206
                                                                                                                          91.06508875739645, 9.213017548689407
                                                                                                                           91.8639053254438, 13.286182593697028
                                                                                                                            92.66272189349112, 15.714909783690118
                                                                                                                             93.46153846153845, 11.897263089813904
                                                                                                                              94.2603550295858, 11.3823735403464
                                                                                                                               95.05917159763314, 12.398864734984537
                                                                                                                                95.85798816568047, 16.057986940716
                                                                                                                                 96.65680473372781, 12.192478059802786
                                                                                                                                  97.45562130177515, 9.871820582826196
                                                                                                                                   98.2544378698225, 13.420947670698396
                                                                                                                                    99.05325443786982, 13.920139386863301
                                                                                                                                     99.85207100591715, 15.575565110419303
                                                                                                                                      100.6508875739645, 14.852399487247453
                                                                                                                                       101.44970414201183, 12.769667923416877
                                                                                                                                        102.24852071005917, 12.343943624886672
                                                                                                                                         103.04733727810651, 14.126667342237042
                                                                                                                                          103.84615384615385, 13.054128977433757
                                                                                                                                           104.64497041420118, 15.996771080747541
                                                                                                                                            105.44378698224853, 15.749266912848658
                                                                                                                                             106.24260355029585, 14.494335290746388
                                                                                                                                              107.0414201183432, 12.57588461396024
                                                                                                                                               107.84023668639053, 12.153077470952347
                                                                                                                                                108.63905325443787, 11.311520145510867
                                                                                                                                                 109.43786982248521, 11.720086705831145
                                                                                                                                                  110.23668639053254, 9.041643780367673
                                                                                                                                                   111.03550295857988, 3.2412713744691533
                                                                                                                                                    111.83431952662723, 11.576054743745432
                                                                                                                                                     112.63313609467457, 5.798794047549827
                                                                                                                                                      113.43195266272188, 11.816037372668044
                                                                                                                                                       114.23076923076923, 9.489812525666176
                                                                                                                                                        115.02958579881657, 9.11925692045308
                                                                                                                                                         115.82840236686391, 8.148951943579902
                                                                                                                                                          116.62721893491124, 11.107432299571784
                                                                                                                                                           117.42603550295858, 12.774216161177545
                                                                                                                                                            118.22485207100593, 12.929051549633733
                                                                                                                                                             119.02366863905324, 14.131089854939379
                                                                                                                                                              119.82248520710058, 15.006648580685239
                                                                                                                                                               120.62130177514793, 15.56832464038057
                                                                                                                                                                121.42011834319527, 16.632983937706065
                                                                                                                                                                 122.2189349112426, 22.081993380090495
                                                                                                                                                                  123.01775147928994, 19.166862726266373
                                                                                                                                                                   123.81656804733728, 25.8214007515718
                                                                                                                                                                    124.61538461538463, 25.504299218901366
                                                                                                                                                                     125.41420118343194, 24.624021152151684
                                                                                                                                                                      126.21301775147928, 25.89399041738482
                                                                                                                                                                       127.01183431952663, 24.257455722335987
                                                                                                                                                                        127.81065088757396, 34.21087559572331
                                                                                                                                                                         128.60946745562129, 32.1070852350532
                                                                                                                                                                          129.40828402366864, 31.921961687815507
                                                                                                                                                                           130.20710059171597, 31.808550095283618
                                                                                                                                                                            131.0059171597633, 24.703059872505158
                                                                                                                                                                             131.80473372781066, 25.12462671303589
                                                                                                                                                                              132.60355029585799, 25.807749646147123
                                                                                                                                                                               133.40236686390534, 23.174431135515345
                                                                                                                                                                                134.20118343195267, 23.708422548248347' 
    fill='none' stroke='#ed5565' stroke-width='1.25'/>
        </svg>"
        );
    }
    

}
?>